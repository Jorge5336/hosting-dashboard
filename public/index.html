<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Carleton TOC — Hosting Prep & Execution</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;700&family=Playfair+Display:wght@500;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <header class="topbar">
    <div class="brand">
      <span class="wordmark">Carleton</span>
      <span class="divider">|</span>
      <span class="appname">TOC — Hosting Prep & Execution</span>
    </div>
    <nav class="actions">
      <button id="open-admin" class="btn maize">Admin</button>
    </nav>
  </header>

  <main id="app" class="container">
    <section id="error-panel" class="card hidden">
      <h2>Oops.</h2>
      <p>Could not load data yet. If this is a fresh deploy, add some data via <strong>Admin</strong>.</p>
      <div class="tips">
        <details>
          <summary>Why am I seeing this?</summary>
          <ul>
            <li>No seed data in storage yet (normal on first run).</li>
            <li>Functions failed to deploy (Netlify → Functions tab).</li>
            <li>Missing <code>ADMIN_SECRET</code> env var.</li>
          </ul>
        </details>
      </div>
      <div class="cta-row">
        <button id="error-open-admin" class="btn maize">Open Admin</button>
        <button id="retry" class="btn outline">Retry</button>
      </div>
    </section>

    <section class="grid">
      <div class="kpi">
        <h3 class="kpi-label">Tasks (Open)</h3>
        <div id="kpi-tasks-open" class="kpi-value">–</div>
      </div>
      <div class="kpi">
        <h3 class="kpi-label">Tasks (Done)</h3>
        <div id="kpi-tasks-done" class="kpi-value">–</div>
      </div>
      <div class="kpi">
        <h3 class="kpi-label">Hosts</h3>
        <div id="kpi-hosts" class="kpi-value">–</div>
      </div>
      <div class="kpi">
        <h3 class="kpi-label">Budget Used</h3>
        <div id="kpi-budget" class="kpi-value">–</div>
      </div>
    </section>

    <section class="card">
      <h2>Recent Tasks</h2>
      <table id="tasks-table">
        <thead>
          <tr>
            <th>Task</th><th>Section</th><th>Due</th><th>Status</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </section>

    <section class="card">
      <h2>Hosts</h2>
      <table id="hosts-table">
        <thead>
          <tr>
            <th>Name</th><th>Email</th><th>Status</th><th>Year</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </section>
  </main>

  <div id="admin-modal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="admin-title">
    <div class="modal-content">
      <div class="modal-head">
        <h2 id="admin-title">Admin</h2>
        <button id="close-admin" class="icon-btn" aria-label="Close">&times;</button>
      </div>
      <div class="modal-body">
        <label class="stack">
          <span>Admin secret</span>
          <input id="admin-secret" type="password" placeholder="Paste ADMIN_SECRET">
        </label>
        <div class="row">
          <button id="save-secret" class="btn maize">Save Secret</button>
          <button id="clear-secret" class="btn outline">Clear</button>
        </div>
        <hr/>
        <details>
          <summary><strong>Import Asana JSON</strong> (paste full export)</summary>
          <textarea id="asana-input" rows="8" placeholder="{ &quot;data&quot;: [ ... ] }"></textarea>
          <button id="import-asana" class="btn">Import</button>
        </details>
        <details>
          <summary><strong>Upload Hosts CSV</strong> (id,name,email,status,class_year,dorm,notes)</summary>
          <textarea id="hosts-csv" rows="6" placeholder="id,name,email,status,class_year,dorm,notes"></textarea>
          <button id="upload-hosts" class="btn">Upload</button>
        </details>
        <details>
          <summary><strong>Add Budget Item</strong></summary>
          <div class="grid2">
            <input id="budget-desc" placeholder="Description">
            <input id="budget-amount" placeholder="Amount (e.g., 125.50)">
          </div>
          <button id="add-budget" class="btn">Add</button>
        </details>
        <details>
          <summary><strong>Add Doc Link</strong></summary>
          <div class="grid2">
            <input id="doc-title" placeholder="Title">
            <input id="doc-url" placeholder="https://...">
          </div>
          <button id="add-doc" class="btn">Add</button>
        </details>
        <details>
          <summary><strong>Add Comms Row</strong></summary>
          <div class="grid2">
            <input id="comms-channel" placeholder="Channel (IG, Email, etc.)">
            <input id="comms-note" placeholder="Note">
          </div>
          <button id="add-comms" class="btn">Add</button>
        </details>
        <hr/>
        <button id="export-json" class="btn outline">Export Snapshot</button>
      </div>
    </div>
  </div>

  <footer class="footer">
    <small>Built for a delightful home for intellectual enthusiasm. Also: coffee & playlists fuel this thing.</small>
  </footer>

  <script src="app.js" type="module"></script>
</body>
</html>